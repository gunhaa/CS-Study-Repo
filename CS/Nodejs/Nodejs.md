# Nodejs

- Node.js는 브라우저 환경이 아닌 서버 측에서 JavaScript를 실행할 수 있게 해주는 런타임이다

## Nodejs 설계 철학

- nodejs는 몇 가지 원칙을 기반으로 자신의 기초를 구성하였다
  - 최소한의 기능 세트를 가지고 코어 바깥 부분에 유저랜드/유저스페이스 라 불리는 사용자 전용 모듈 생태계를 가진다
- nodejs는 프로그램 코드를 구성하는 기본적인 수단으로 모듈 개념을 사용한다
  - nodejs에서 가장 널리 통용되는 원칙 중 하나는 코드의 양 뿐 아니라 범위의 측면에서도 작은 모듈을 디자인 하는 것이다
  - 이 원칙은 Unix철학에 근거하며, 두가지 수칙이 있다
    - 작은 것이 아름답다
    - 각 프로그램은 한 가지 역할만 잘 하도록 만들어야 한다
  - nodejs는 이 개념을 바탕으로 npm을 만들어, 자신이 필요로 하는 종속성 패키지를 갖도록 함으로써 종속성 지옥을 벗어날 수 있도록 한다
  - 이 작은 모듈은 재사용성이라는 장점 이외에도 다른 장점이 있다
    - 이해하기 쉽고 사용하기 쉽다
    - 테스트 및 유지보수가 쉽다
    - 사이즈가 작아 브라우저에서 사용하기에 완벽하다
- nodejs의 핵심 아키텍쳐는 reactor패턴으로 구성되어 있다
    - nodejs를 이해하기 위해서는 비동기 특성의 핵심적인 특성인 리액터 패턴을 이해해야 한다
        - 리액터 패턴은 이벤트 루프 기반의 구조로, 하나의 스레드가 여러 I/O 이벤트를 처리할 수 있게 해준다
        - Node.js는 하나의 이벤트 루프가 모든 클라이언트의 I/O를 처리한다
    - 리액터 패턴의 구성요소
        - Event Demultiplexer: 커널 레벨에서 I/O 이벤트를 감지
        - Event Loop: 이벤트가 발생했는지 확인하며 순회
        - Callback Dispatcher: 이벤트가 발생하면 해당 콜백을 실행
    - busy-waiting과 이를 극복하기 위해 nodejs가 사용하는 이벤트 디멀티플렉싱을 이해해야 한다

## Nodejs의 구성

- 기본 구성
  - core javascript API
    - `setTimeout`, `Promise`, `console`, `require` 같은 Node.js 환경에 맞게 확장된 JS의 표준 또는 Node 자체 기능들을 말한다
  - libuv
    - Node.js가 논블로킹 I/O를 지원하게 해주는 핵심 라이브러리이며, 다음 기능을 담당한다
        - 이벤트 루프
        - 스레드 풀 (파일 읽기 등 블로킹 I/O 처리)
        - 비동기 TCP/UDP 소켓
        - 파일 시스템 작업 등
        - 즉, 브라우저 없이도 JavaScript로 비동기 처리를 가능하게 해주는 기반이다.
  - V8
    - 크롬을 위해 구글이 개발한 js엔진으로 nodejs가 빠르고 효율적인 이유이다.
    - v8은 혁신적인 설계와 속도 그리고 효율적인 메모리 관리로 높은 평가를 받고 있다