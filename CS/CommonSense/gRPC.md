# gRPC

> gRPC는 원격 프로시저 호출(RPC, Remote Procedure Call)을 위한 통신 라이브러리

- RPC : Remote Procedure Call의 약자로 별도의 원격 제어를 위한 코딩 없이 다른 주소 공간에서 함수나 프로시저를 실행할 수 있게하는 프로세스 간 통신 기술이다. 쉽게 설명해서 MSA(Micro Service Architecture)구조롤 서비스를 만들게 되면, 다양한 언어와 프레임워크로 개발되는 경우가 있는데, 이러한 구조에 RPC를 이용하여 언어에 구애받지 않고, 원격에 있는 프로시저를 호출하여 고유 프로그램의 개발에 집중할 수 있게 해주는 기술이다

- gRPC는 HTTP/2 기반이다

- Protocol Buffers(proto 파일)를 사용하여 인터페이스를 정의하고, 이를 기반으로 서버와 클라이언트 코드를 자동 생성한다.

## 특징 
1. 높은 생산성과 다양한 언어 및 플랫폼 지원<br>
    gRPC는 서비스와 메시지를 정의하기 위해 Protocol Buffers를 사용한다. 프로토콜 버퍼의 IDL만 정의하면 서비스와 메세지에 대한 소스코드가 자동으로 생성되고 데이터를 주고 받을 수 있다.

2. HTTP/2 기반의 양방향 스트리밍<br>
    gRPC는 HTTP/2 기반으로 통신한다. HTTP/2는 하나의 TCP 연결이 여러 개의 양방향 스트리밍을 지원한다.

3. 성능 이점<br>
    gRPC는 HTTP/2 레이어 위에서 Protocol Buffers를 사용해 직렬화된 바이트 스트림으로 통신하여 JSON 기반의 통신보다 더 가볍고 통신 속도가 빠르다. 때문에 laytency 감소와 더 많은 트래픽을 처리할 수 있는 성능의 이점이 있다.

## 직렬화 방법

```proto
message Person {
  string name = 1;
  int32 age = 2;
}
```

- http 통신의 경우 byte stream으로 그대로 binary로 바꿔서 보낸다 하지만 gRPC의 경우는 이와 다르게 binary로 압축시켜 최적화 시킨다

### gRPC의 직렬화

 `0A 05 41 6C 69 63 65 10 19`

- `0A` : name 필드 (1번 필드, 문자열)
- `05` : 길이(5바이트)
- `41 6C 69 63 65` : "Alice" 문자열 (ASCII)
- `10`: age 필드 (2번 필드, 정수)
- `19`: 25 (16진수 0x19 = 10진수 25)

- 일반 직렬화에 비해 빠른이유
    - 필드명이 저장되지 않음 → 크기 작음
    - 바이너리 포맷이라 빠르게 변환 가능
    - 정수형 데이터를 압축해 저장